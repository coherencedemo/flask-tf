{% extends "base.tf.j2" %}

{% block environment_resources %}
{{ super() }}

resource "google_storage_bucket" "custom_bucket" {
  name     = "bucket-{{ environment.name }}-{{ env_collection.account_id }}"
  location = "{{ env_collection.region }}"
  force_destroy = true

  uniform_bucket_level_access = true
  public_access_prevention = "inherited"
}

resource "google_storage_bucket_iam_member" "public_read" {
  bucket = google_storage_bucket.custom_bucket.name
  role   = "roles/storage.objectViewer"
  member = "allUsers"
}
{% endblock %}